<div class="login-wrapper">

  <!-- Left Panel: Branding -->
  <div class="login-brand">
    <div class="brand-content">
      <div class="brand-logo">
        <span class="material-icons">restaurant</span>
      </div>
      <h1 class="brand-title">KOS</h1>
      <p class="brand-subtitle">Kitchen Operations System</p>
      <div class="brand-roles">
        <span class="role-badge" (click)="fillRole('admin')">Admin</span>
        <span class="role-badge" (click)="fillRole('owner')">Owner</span>
        <span class="role-badge" (click)="fillRole('manager')">Manager</span>
        <span class="role-badge" (click)="fillRole('cashier')">Cashier</span>
        <span class="role-badge" (click)="fillRole('billing')">Billing</span>
        <span class="role-badge" (click)="fillRole('chef')">Chef</span>
        <span class="role-badge" (click)="fillRole('waiter')">Waiter</span>
    </div>
      <p class="brand-hint">Click role to quick-fill (dev only)</p>
    </div>
  </div>

  <!-- Right Form Panel -->
  <div class="login-form-panel">
    <div class="login-card">

      <div class="login-header">
        <h2>Welcome to KOS</h2>
        <p>Sign in to continue</p>
      </div>

      <!-- Error Banner -->
      <div class="error-banner" *ngIf="errorMessage" role="alert">
        <span class="material-icons">error_outline</span>
        {{ errorMessage }}
      </div>

      <!-- Tab Switcher -->
      <div class="tab-switcher">
        <button [class.active]="activeTab === 'password'" (click)="setTab('password')">
          <span class="material-icons">lock</span> Password
        </button>
        <button [class.active]="activeTab === 'mobile'" (click)="setTab('mobile')">
          <span class="material-icons">smartphone</span> Mobile OTP
        </button>
      </div>

      <!-- ── Password Tab ── -->
      <form *ngIf="activeTab === 'password'" (ngSubmit)="onPasswordSubmit()" novalidate>
        <div class="form-group">
          <label>Username</label>
          <div class="input-wrapper">
            <span class="material-icons input-icon">person</span>
            <input type="text" [(ngModel)]="username" name="username"
                   placeholder="Enter username" autocomplete="username" />
          </div>
        </div>
        <div class="form-group">
          <label>Password</label>
          <div class="input-wrapper">
            <span class="material-icons input-icon">lock</span>
            <input [type]="showPassword ? 'text' : 'password'"
                   [(ngModel)]="password" name="password"
                   placeholder="Enter password" autocomplete="current-password" />
            <span class="material-icons toggle-eye" (click)="togglePassword()">
              {{ showPassword ? 'visibility_off' : 'visibility' }}
            </span>
          </div>
        </div>
        <button type="submit" class="btn-login" [disabled]="isLoading">
          <span class="material-icons spin" *ngIf="isLoading">autorenew</span>
          <span>{{ isLoading ? 'Signing in...' : 'Sign In' }}</span>
        </button>
      </form>

      <!-- ── Mobile OTP Tab ── -->
      <form *ngIf="activeTab === 'mobile'" (ngSubmit)="onOtpSubmit()" novalidate>
        <div class="form-group">
          <label>Mobile Number</label>
          <div class="input-wrapper">
            <span class="material-icons input-icon">smartphone</span>
            <input type="tel" [(ngModel)]="mobile" name="mobile"
                   placeholder="Enter 10-digit mobile" maxlength="10" />
            <button type="button" class="btn-otp"
                    (click)="sendOtp()"
                    [disabled]="otpTimer > 0">
              {{ otpTimer > 0 ? otpTimer + 's' : (otpSent ? 'Resend' : 'Send OTP') }}
            </button>
          </div>
        </div>
        <div class="form-group" *ngIf="otpSent">
          <label>Enter OTP</label>
          <div class="input-wrapper">
            <span class="material-icons input-icon">pin</span>
            <input type="text" [(ngModel)]="otp" name="otp"
                   placeholder="Enter OTP" maxlength="6" />
          </div>
        </div>
        <button type="submit" class="btn-login" [disabled]="isLoading || !otpSent">
          <span class="material-icons spin" *ngIf="isLoading">autorenew</span>
          <span>{{ isLoading ? 'Verifying...' : 'Verify & Sign In' }}</span>
        </button>
      </form>

      <!-- ── Divider ── -->
      <div class="divider"><span>or continue with</span></div>

      <!-- ── Social Buttons ── -->
      <div class="social-buttons">
        <button class="btn-social btn-google" (click)="loginWithGoogle()" [disabled]="isLoading">
          <img src="assets/icons/google.svg" alt="Google"
               onerror="this.style.display='none'" />
          <span>Google</span>
        </button>
        <button class="btn-social btn-zoho" (click)="loginWithZoho()" [disabled]="isLoading">
          <img src="assets/icons/zoho.svg" alt="Zoho"
               onerror="this.style.display='none'" />
          <span>Zoho Mail</span>
        </button>
      </div>

      <p class="login-hint">First time login? You'll be registered as <strong>Owner</strong></p>

    </div>
  </div>
</div>